i#!/usr/bin/env bash
# Configure your Nginx server so that /redirect_me is redirecting to another page
# The redirection is configured as a "301 Moved Permanently"

sudo apt-get update
sudo apt-get install -y nginx

sudo mkdir -p /var/www/html

echo "Hello World!" | sudo tee /var/www/html/index.html

nginx_config="server {
	listen 80;
	listen [::]:80 default_server;
	root	/var/www/html;
	index	index.html index.htm;
	location /redirect_me {
		return 301 https://www.twitter.com/Stevenob12;
	}
}"

nginx_available="/etc/nginx/sites-available/redirect"
nginx_enabled="/etc/nginx/sites-enabled/redirect"

if [ ! -f "$nginx_available" ]; then
	eccho -e "$nginx_config" | sudo tee "$nginx_available"
fi

if [ ! -f "$nginx_enabled" ]; then
	sudo ln -s "$nginx_available" "$nginx_enabled"
fi

sudo nginx -t
sudo systemctl reload nginx
